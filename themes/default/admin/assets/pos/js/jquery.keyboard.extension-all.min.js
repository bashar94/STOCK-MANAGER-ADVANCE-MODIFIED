/*! jQuery.mousewheel.js Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net) MIT License
 * Version: 3.0.6 Requires: 1.2.2+ */
(function(d){function e(a){var b=a||window.event,c=[].slice.call(arguments,1),f=0,e=0,g=0;a=d.event.fix(b);a.type="mousewheel";b.wheelDelta&&(f=b.wheelDelta/120);b.detail&&(f=-b.detail/3);g=f;void 0!==b.axis&&b.axis===b.HORIZONTAL_AXIS&&(g=0,e=-1*f);void 0!==b.wheelDeltaY&&(g=b.wheelDeltaY/120);void 0!==b.wheelDeltaX&&(e=-1*b.wheelDeltaX/120);c.unshift(a,f,e,g);return(d.event.dispatch||d.event.handle).apply(this,c)}var c=["DOMMouseScroll","mousewheel"];if(d.event.fixHooks)for(var h=c.length;h;)d.event.fixHooks[c[--h]]= d.event.mouseHooks;d.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=c.length;a;)this.addEventListener(c[--a],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var a=c.length;a;)this.removeEventListener(c[--a],e,!1);else this.onmousewheel=null}};d.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})})(jQuery);

/* jQuery UI Virtual Keyboard Extensions ~ https://github.com/Mottie/Keyboard * By Rob Garrison ~ MIT license */
/* Autocomplete v1.5 for Keyboard v1.18+ only (3/1/2014) */
(function(d){d.fn.addAutocomplete=function(){return this.each(function(){var a=d(this).data("keyboard");a&&(a.autocomplete_new_version=function(a){a[0]=parseInt(a[0],10);return 1<a[0]||1===a[0]&&9<=parseInt(a[1],10)}(d.ui.version.split(".")),a.autocomplete_init=function(b,c,d){a.options.alwaysOpen&&a.isVisible()&&a.autocomplete_setup();a.$el.bind("visible.keyboard",function(){a.autocomplete_setup()}).bind("change.keyboard",function(){a.hasAutocomplete&&a.isVisible()&&a.$el.val(a.$preview.val()).trigger("keydown.autocomplete")}).bind("hidden.keyboard", function(b){a.$el.autocomplete("close")}).bind("autocompleteopen",function(b,c){a.hasAutocomplete&&a.$autocomplete.menu.element.position({of:a.$keyboard,my:"right top",at:"left top",collision:"flip"})}).bind("autocompleteselect",function(b,c){var d=c.item.value;a.hasAutocomplete&&""!==d&&(a.$preview.val(d).focus(),a.lastCaret={start:d.length,end:d.length})})},a.autocomplete_setup=function(){a.$autocomplete=a.$el.data("autocomplete")||a.$el.data("uiAutocomplete");a.hasAutocomplete="undefined"===typeof a.$autocomplete? !1:a.$autocomplete.options.disabled?!1:!0;a.hasAutocomplete&&(a.$preview.bind("keydown",function(b){return a.autocomplete_input(b)}),a.$allKeys.bind("mouseup mousedown mouseleave touchstart touchend touchcancel",function(b){a.autocomplete_input(b)}))},a.autocomplete_input=function(b){var c;c=d.ui.keyCode;switch(b.keyCode){case c.PAGE_UP:a.$autocomplete._move("previousPage",b);b.preventDefault();break;case c.PAGE_DOWN:a.$autocomplete._move("nextPage",b);b.preventDefault();break;case c.UP:a.$autocomplete._move("previous", b);b.preventDefault();break;case c.DOWN:a.$autocomplete._move("next",b);b.preventDefault();break;case c.ENTER:case c.NUMPAD_ENTER:c=a.$autocomplete.menu.element.find("#ui-active-menuitem,.ui-state-focus").text()||"";""!==c&&a.$preview.val(c);a.autocomplete_new_version&&a.$autocomplete.menu.select(b);break;default:clearTimeout(a.$autocomplete.searching),a.$autocomplete.searching=setTimeout(function(){a.$autocomplete.term!==a.$autocomplete.element.val()&&(a.$autocomplete.selectedItem=null,a.$autocomplete.search(null, b))},a.$autocomplete.options.delay)}},a.origEscClose=a.escClose,a.escClose=function(b){a.hasAutocomplete&&("ui-active-menuitem"===b.target.id||d(b.target).closest("ul").hasClass("ui-autocomplete"))||a.origEscClose(b)},a.autocomplete_init())})}})(jQuery);

/* jQuery Mobile Themes v1.2 for keyboard v1.18+ (updated 6/1/2014) */
(function(d){d.fn.addMobile=function(f){var b,g={container:{theme:"b",cssClass:"ui-body"},input:{theme:"b",cssClass:""},buttonMarkup:{theme:"b",cssClass:"ui-btn",shadow:"true",corners:"true"},buttonHover:{theme:"b",cssClass:"ui-btn-hover"},buttonAction:{theme:"b",cssClass:"ui-btn-active"},buttonActive:{theme:"b",cssClass:"ui-btn-active"}};return this.each(function(){var a=d(this).data("keyboard");a&&"undefined"!==typeof d.fn.textinput&&(a.mobile_options=b=d.extend(!0,{},g,f),a.mobile_init=function(){d(".ui-keyboard-input").textinput(); a.options.alwaysOpen&&a.isVisible&&a.mobile_setup();a.$el.on("beforeVisible.keyboard",function(){a.$keyboard.css("visibility","hidden")}).on("visible.keyboard",function(){a.mobile_setup();a.$keyboard.css("visibility","visible");a.$preview.focus()})},a.mobile_setup=function(){var c;c=a.options;var e=b.buttonMarkup.cssClass||"",f=c.css.buttonAction;c.css.buttonAction+=" "+b.buttonAction.cssClass;a.$keyboard.addClass(a.modOptions(b.container,b.container)).find(".ui-keyboard-preview").addClass(a.modOptions(b.input, b.input)).end().removeClass("ui-widget ui-widget-content").find("."+f).addClass(a.modOptions(b.buttonAction,b.buttonMarkup)).end().find("button").removeClass("ui-corner-all ui-state-default").addClass(a.modOptions(b.buttonMarkup)).hover(function(){d(this).removeClass(e?e+"-"+b.buttonMarkup.theme:"").addClass(a.modOptions(b.buttonHover,b.buttonMarkup))},function(){d(this).removeClass(e?e+"-"+b.buttonHover.theme:"").addClass(a.modOptions(b.buttonMarkup,b.buttonMarkup))});a.msie&&a.$preview[0]!==a.el&& (a.$preview.hide(),a.$keyboard.css("width",""),a.width=a.$keyboard.outerWidth(),a.$keyboard.width(a.width+parseInt(a.$preview.css("fontSize"),10)),a.$preview.width(a.width),a.$preview.show());d.ui&&d.ui.position&&(c=c.position,c.of=c.of||a.$el.data("keyboardPosition")||a.$el,c.collision=c.collision||"flipfit flipfit",a.$keyboard.position(c))},a.modOptions=function(a,b){return" "+(a.cssClass||"")+" "+(b&&b.cssClass?b.cssClass+"-"+(a.theme||""):"")+("true"==a.shadow?" ui-shadow":"")+("true"==a.corners? " ui-corner-all":"")},a.mobile_init())})}})(jQuery);

/* Navigation v1.4 for Keyboard v1.18+ only (updated 3/1/2014) */
(function(e){e.keyboard=e.keyboard||{};e.keyboard.navigationKeys={toggle:112,enter:13,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,caretrt:45,caretlt:46};e.fn.addNavigation=function(n){return this.each(function(){var c,k,a=e(this).data("keyboard");k={position:[0,0],toggleMode:!1,focusClass:"hasFocus"};a&&(a.navigation_options=c=e.extend({},k,n),a.navigation_keys=k=e.extend({},e.keyboard.navigationKeys),a.saveNav=[a.options.tabNavigation,a.options.enterNavigation],a.allNavKeys= e.map(k,function(a,b){return a}),a.navigation_init=function(){a.$keyboard.toggleClass(c.focusClass,c.toggleMode).find(".ui-keyboard-keyset:visible").find('.ui-keyboard-button[data-pos="'+c.position[0]+","+c.position[1]+'"]').addClass("ui-state-hover");a.$preview.unbind("keydown.keyboardNav").bind("keydown.keyboardNav",function(c){return a.checkKeys(c.which)})},a.checkKeys=function(h,b){if("undefined"!==typeof h){var d=a.navigation_keys;if(h===d.toggle||b)c.toggleMode=b?!1:!c.toggleMode,a.options.tabNavigation= c.toggleMode?!1:a.saveNav[0],a.options.enterNavigation=c.toggleMode?!1:a.saveNav[1];a.$keyboard.toggleClass(c.focusClass,c.toggleMode);if(c.toggleMode&&h===d.enter)return a.$keyboard.find(".ui-keyboard-keyset:visible").find('.ui-keyboard-button[data-pos="'+c.position[0]+","+c.position[1]+'"]').trigger("repeater.keyboard"),!1;if(c.toggleMode&&0<=e.inArray(h,a.allNavKeys))return a.navigateKeys(h),!1}},a.navigateKeys=function(h,b,d){d=d||c.position[1];b=b||c.position[0];var e=a.$keyboard.find(".ui-keyboard-keyset:visible"), k=e.find(".ui-keyboard-button-endrow").length-1,l=e.find('.ui-keyboard-button[data-pos^="'+b+',"]').length-1,g=a.lastCaret,m=a.$preview.val().length,f=a.navigation_keys;switch(h){case f.pageup:b=0;break;case f.pagedown:b=k;break;case f.end:d=l;break;case f.home:d=0;break;case f.left:d+=0<d?-1:0;break;case f.up:b+=0<b?-1:0;break;case f.right:d+=1;break;case f.down:b+=b+1>k?0:1;break;case f.caretRt:g.start++;break;case f.caretLt:g.start--}if(h===f.caretRt||h===f.caretLt)g.start=0>g.start?0:g.start> m?m:g.start,g.end=g.start,a.lastCaret=g,a.$preview.focus().caret(g.start,g.start);l=e.find('.ui-keyboard-button[data-pos^="'+b+',"]').length-1;d>l&&(d=l);e.find(".ui-state-hover").removeClass("ui-state-hover");e.find('.ui-keyboard-button[data-pos="'+b+","+d+'"]').addClass("ui-state-hover");c.position=[b,d]},a.options.alwaysOpen&&a.isVisible&&(a.$keyboard.find(".ui-state-hover").removeClass("ui-state-hover"),a.navigation_init()),a.$el.bind("visible.keyboard",function(c){a.$keyboard.find(".ui-state-hover").removeClass("ui-state-hover"); a.navigation_init()}).bind("inactive.keyboard hidden.keyboard",function(c){a.checkKeys(c.which,!0)}).bind("navigate navigateTo",function(c,b,d){b=isNaN(b)?b.toLowerCase():b;a.navigation_keys.hasOwnProperty(b)?a.checkKeys(a.navigation_keys[b]):a.navigateKeys(null,b,d)}))})}})(jQuery);

/* Scramble Extension v1.3 for Keyboard v1.18+ (updated 7/18/2014) */
(function(d){d.keyboard=d.keyboard||{};d.fn.addScramble=function(s){var t={targetKeys:/[a-z\d]/i,byRow:!0,byKeySet:!1,randomizeOnce:!0};return this.each(function(){var e,a=d(this).data("keyboard"),b=a.options;a&&!a.scramble_options&&(e=a.scramble_options=d.extend({},t,s),a.scramble_setup=function(g){var p,k,q,c,b,l,f,n,r,m,h;p=g.find(".ui-keyboard-keyset");if(g.length){e.byKeySet&&(p=p.eq(0));for(k=0;k<p.length;k++)if(q=p.eq(k),f=0,h=[],r=[],n=[],m=[],q.children("button, span, br").each(function(){"BR"=== this.tagName?(e.byRow?(h.push(this),r.push(!1),m[f]=h,n[f]=r,h=[],r=[]):(m[f]=this,n[f]=!1),f++):(l=d(this).attr("data-value")||"",l=1===l.length&&e.targetKeys.test(l)?l:!1,e.byRow?(h.push(this),r.push(l)):(m[f]=this,n[f]=l,f++))}),q.find(".ui-keyboard-button-endrow").remove(),e.byRow)for(b=0;b<m.length;b++)for(h=a.shuffle(m[b],n[b]),c=0;c<h.length;c++)q.append(h[c]);else for(h=a.shuffle(m,n),c=0;c<h.length;c++)q.append(h[c]);e.byKeySet&&(g=a.realign(g));return g}},a.shuffle=function(a,d){for(var k, b,c=a.length;0<c;)b=Math.floor(Math.random()*c),!1===d[c-1]&&c--,!1!==d[c-1]&&!1!==d[b]&&(c--,k=a[c],a[c]=a[b],a[b]=k);return a},a.realign=function(a){var b,k,e,c=a.find(".ui-keyboard-keyset"),s=c.eq(0),c=c.filter(":gt(0)");s.children().each(function(a,f){k="BR"===f.tagName;e=d(f).attr("data-pos");c.each(function(a,c){b=k?"br:first":'button[data-pos="'+e+'"]';d(c).find(b).appendTo(c)})});return a},b.create=function(){var g=b.layout;d.keyboard.builtLayouts[g]={mappedKeys:{},acceptedKeys:[],$keyboard:null}; "undefined"===typeof d.keyboard.builtLayouts[a.orig_layout]&&(a.layout=b.layout=a.orig_layout,a.buildKeyboard(),a.layout=b.layout=g);d.keyboard.builtLayouts[g]=d.extend(!0,{},d.keyboard.builtLayouts[a.orig_layout]);e.randomizeOnce&&(d.keyboard.builtLayouts[g].$keyboard=a.scramble_setup(d.keyboard.builtLayouts[a.orig_layout].$keyboard.clone()));a.$keyboard=d.keyboard.builtLayouts[g].$keyboard;e.randomizeOnce||a.$el.bind("beforeVisible.keyboard",function(a,b){b.$keyboard=b.scramble_setup(b.$keyboard)})}, a.orig_layout=b.layout,b.layout="scrambled"+Math.round(1E4*Math.random()),b.alwaysOpen&&a.$keyboard.length&&setTimeout(function(){a.$keyboard=a.scramble_setup(a.$keyboard)},0))})}})(jQuery);

/* Typing Simulator v1.4 for Keyboard v1.18+ only (3/1/2014) */
(function(g){g.fn.addTyping=function(k){var l={showTyping:!0,delay:250};return this.each(function(){var a=g(this).data("keyboard");a&&(a.typing_options=g.extend({},l,k),a.typing_keymap={" ":"space",'"':"34","'":"39","&nbsp;":"space","\b":"bksp","\n":"Enter","\r":"Enter","\t":"tab"},a.typing_xref={8:"bksp",9:"tab",13:"enter",32:"space"},a.typing_event=!1,a.typing_setup=function(){(a.$preview?a.$preview:a.$el).bind("keyup.keyboard",function(b){37<=b.which&&40>=b.which||(16===b.which&&(a.shiftActive= !1),18===b.which&&(a.altActive=!1),16!==b.which&&18!==b.which)||(a.showKeySet(),setTimeout(function(){a.$preview.focus()},200))}).bind("keydown.keyboard",function(b){b.temp=!1;16===b.which&&(b.temp=a.shiftActive?!1:!0,a.shiftActive=!0);18===b.which&&(b.temp=a.altActive?!1:!0,a.altActive=!0);b.temp&&(a.showKeySet(),a.$preview.focus());a.typing_event=!0;8!==b.which&&9!==b.which||a.typeIn("",a.typing_options.delay||250,function(){a.typing_event=!1},b)}).bind("keypress.keyboard",function(b){a.typing_event&& !a.options.lockInput&&a.typeIn("",a.typing_options.delay||250,function(){a.typing_event=!1},b)})},a.typeIn=function(b,e,f,c){if(a.isVisible()){var d=a.typing_options,h=g.keyboard.builtLayouts[a.layout].mappedKeys;!0!==a.typing_options.init&&(d.init=!0,d.text=b,d.len=b.length,d.delay=e||300,d.current=0,d.callback=f);b=d.text.substring(d.current,++d.current);e=a.$keyboard.find(".ui-keyboard-keyset");f='.ui-keyboard-button[data-value="'+(a.typing_keymap.hasOwnProperty(b)?a.typing_keymap[b]:b)+'"]';a.typing_event&& c&&(a.typing_xref.hasOwnProperty(c.keyCode||c.which)?f=".ui-keyboard-"+a.typing_xref[c.keyCode||c.which]:(f=String.fromCharCode(c.charCode||c.which),f=h.hasOwnProperty(f)?'.ui-keyboard-button[data-value="'+h[f]+'"]':".ui-keyboard-"+(c.charCode||c.which)));c=e.filter(":visible").find(f);c.length?a.typing_simulateKey(c,b):(a.typing_event?c=e.find(f):(c=a.typing_keymap.hasOwnProperty(b)?a.typing_keymap[b]:b.charCodeAt(0),"bksp"===c&&(b=c),c=e.find(".ui-keyboard-"+c)),e=c.closest(".ui-keyboard-keyset"), e.attr("name")?(e=e.attr("name"),a.shiftActive=/shift/.test(e),a.altActive=/alt/.test(e),a.metaActive=a.lastKeyset[2]=e.match(/meta\d+/)||!1,a.showKeySet({name:a.metaActive}),a.typing_simulateKey(c,b)):a.typing_event||(a.insertText(b),a.checkCombos()));d.current<d.len?a.isVisible()&&setTimeout(function(){a.typeIn()},d.delay):(d.init=!1,g.isFunction(d.callback)&&setTimeout(function(){d.callback(a)},d.delay))}else a.typing_options.init=!1,clearTimeout(a.typing_timer)},a.typing_simulateKey=function(b, e){var f=b.length;f&&b.filter(":visible").trigger("mouseenter.keyboard");a.typing_timer=setTimeout(function(){f&&setTimeout(function(){b.trigger("mouseleave.keyboard")},a.typing_options.delay/3);a.isVisible()&&!a.typing_event&&(a.insertText(e),a.checkCombos())},a.typing_options.delay/3)},a.typing_options.showTyping&&(a.options.alwaysOpen&&a.isVisible()&&a.typing_setup(),a.$el.bind("visible.keyboard",function(){a.typing_setup()})))})}})(jQuery);
